<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ƒê·ªÅ 1 - K50</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
.question img {
  display: block;
  margin: 10px auto; /* cƒÉn gi·ªØa ngang */
  border: 1px solid #ddd;
  border-radius: 8px;
  max-width: 90%; /* t·ª± co n·∫øu ·∫£nh l·ªõn qu√° */
}

    :root{
      --white:#ffffff;
      --card:#f7fbff;
      --accent:#0ea5b7;
      --muted:#64748b;
      --success:#10b981;
      --warning:#f59e0b;
      --warning-text:#2b1700;
      --shadow: 0 10px 30px rgba(2,6,23,0.08);
      --footer-blue-start: #0b2e6b;
      --footer-blue-end: #062969;
      --footer-height: 120px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--white); color:#0b1220}

    /* LOGIN + SCORE overlays */
    .overlay-screen{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background: linear-gradient(180deg,#07336a,#0b2340); z-index:600; padding:20px; }
    .card{ width:520px; max-width:98%; background:#fff; border-radius:12px; padding:26px; box-shadow:var(--shadow); text-align:center; }
    .card.large { width:720px; max-width:98%; }

    .field{ text-align:left; margin:14px 0; }
    .field label{ display:block; font-size:14px; color:var(--muted); margin-bottom:8px; }
    .field input{ width:100%; padding:12px 14px; border:1px solid rgba(2,6,23,0.08); border-radius:10px; font-size:16px; }

    .btn{ padding:10px 16px; border-radius:10px; border:0; cursor:pointer; font-weight:700; font-size:15px; }
    .btn-primary{ background:var(--accent); color:#042024; }
    .btn-ghost{ background:transparent; border:1px solid rgba(2,6,23,0.06); color:#042024; }
    .btn-warning{ background:var(--warning); color:var(--warning-text); border:0; box-shadow: 0 6px 18px rgba(0,0,0,0.12); }

    /* Candidate strip (original look) */
.candidate-strip{
  width:100%;
  box-sizing:border-box;
  background:#0f274a;
  color:#eaf6ff;
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  box-shadow:var(--shadow);

  position: fixed;   /* ‚úÖ C·ªê ƒê·ªäNH */
  top: 0;
  left: 0;
  right: 0;
  z-index: 500;      /* cao h∆°n n·ªôi dung */
}

    .candidate-inner{ max-width:1400px; margin:0 auto; width:100%; display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .candidate-info{ display:flex; gap:14px; align-items:center; font-size:13px; }
    .candidate-info .name{ font-weight:700; color:#fff; }
    .candidate-controls{ display:flex; gap:8px; align-items:center; }
    .btn-primary{ background:var(--accent); color:#042024; border:0; padding:8px 12px; border-radius:8px; font-weight:700; cursor:pointer; }
    .btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,0.12); padding:8px 10px; border-radius:8px; color:#eaf6ff; cursor:pointer; }
    .timer-bubble{ background: rgba(255,255,255,0.08); padding:6px 10px; border-radius:20px; font-weight:700; color:#fff; }

    /* page content: full width layout (original) */
    .page-wrap{ max-width: none; width: calc(100% - 36px); margin:18px auto 0; padding:18px; background:var(--card); border-radius:10px; box-shadow:var(--shadow); padding-bottom: calc(var(--footer-height) + 20px); }

    .content h1{ margin:0 0 14px 0; text-align:center; font-size:18px; color:#08263b; }

    .score-panel{ display:none; background:#fff; border-radius:10px; padding:14px; box-shadow: 0 14px 40px rgba(2,6,23,0.08); border:1px solid rgba(2,6,23,0.04); margin-bottom:12px; }
    .score-title{ font-weight:800; font-size:18px; color:#09324a; }
    .score-sub{ color:#334155; font-weight:600 }

    .quiz-area{ position:relative; }
    .quiz-wrapper{ padding:8px 2px; max-width:1400px; margin:0 auto; }
    .question{ background:#fff; border-radius:8px; padding:12px; margin-bottom:12px; border:1px solid rgba(2,6,23,0.04); display:block; box-shadow: 0 6px 20px rgba(2,6,23,0.03); }
    .q-head{ display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .q-left{ display:flex; gap:10px; align-items:center; }
    .qnum{ width:36px; height:36px; border-radius:8px; background:#f1f5f9; display:flex; align-items:center; justify-content:center; font-weight:700; color:#0b1220; }
    .qtitle{ font-weight:600; color:#0b1220; }
    .flag-btn{ background:transparent; border:1px solid rgba(2,6,23,0.05); padding:6px 8px; border-radius:8px; cursor:pointer; }
    .options{ margin-top:10px; display:flex; flex-direction:column; gap:8px; }
    label.option{ display:flex; align-items:center; gap:8px; padding:10px; border-radius:8px; border:1px solid rgba(2,6,23,0.04); cursor:pointer; background:#fff; }
    input[type="number"]{ padding:8px; border-radius:6px; border:1px solid rgba(2,6,23,0.06); width:160px; }

    .tf-table{ width:100%; border-collapse:collapse; table-layout:fixed; margin-top:8px; }
    .tf-table th, .tf-table td{ padding:8px; border:1px solid rgba(2,6,23,0.06); vertical-align:middle; }
    .tf-table thead th:nth-child(1){ width:34px; max-width:34px; text-align:center; }
    .tf-table thead th:nth-child(2){ width:auto; }
    .tf-table thead th:nth-child(3), .tf-table thead th:nth-child(4){ width:60px; max-width:60px; text-align:center; }
    .tf-table td:nth-child(2){ white-space:normal; word-wrap:break-word; }

   .quiz-overlay{
  position:absolute;
  inset:0;
  background:transparent;   /* ‚ùå b·ªè n·ªÅn ƒëen */
  z-index:40;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;      /* kh√¥ng ch·∫∑n nh√¨n */
}

    .quiz-overlay.hidden{ display:none; }
   .quiz-overlay .msg{
  background:#f1f5f9;
  color:#0b1220;
  padding:12px 18px;
  border-radius:10px;
  font-weight:700;
  box-shadow:0 8px 24px rgba(0,0,0,0.12);
}


    .site-footer{ position: fixed; left: 0; right: 0; bottom: 0; background: linear-gradient(180deg, var(--footer-blue-start), var(--footer-blue-end)); padding: 14px 0; display: flex; justify-content: center; z-index: 80; box-shadow: 0 -8px 30px rgba(0,0,0,0.25); }
    .footer-inner{ width: 100%; max-width: 1400px; padding: 1px 4px; display: flex; justify-content: space-between; align-items: center; border-radius: 20px; background: linear-gradient(180deg, #0d47a1, #083a8c); box-shadow: inset 0 0 10px rgba(0,0,0,0.2); }
    .bubbles-wrap{ display: flex; gap: 8px; align-items: center; flex-wrap:wrap;}
    .bubble{ width: 34px; height: 34px; border-radius: 50%; display: grid; place-items: center; font-weight: 700; cursor: pointer; background: rgba(255,255,255,0.15); color: #fff; border: 2px solid rgba(255,255,255,0.1); }
    .bubble.done{ background: linear-gradient(180deg,#22c55e,#10b981); color: #07211a; border-color: rgba(0,0,0,0.09); }
    .bubble.flagged{ background: linear-gradient(180deg,#f59e0b,#f97316); color: #2b1700; border-color: rgba(0,0,0,0.09); }

    .footer-note{ color: #fff; font-size: 13px; margin-left: 12px; opacity: 0.95; }

    .controls{ display:flex; gap:10px; align-items:center; justify-content:flex-end; margin-bottom:12px; }
    .primary{ background:var(--accent); color:#042024; padding:8px 12px; border-radius:8px; border:0; cursor:pointer; font-weight:700; }
    .ghost{ background:transparent; border:1px solid rgba(2,6,23,0.06); padding:8px 12px; border-radius:8px; cursor:pointer; }

    @media (max-width:900px){
      .candidate-inner{ flex-direction:column; align-items:flex-start; gap:8px; }
      .page-wrap{ width: calc(100% - 20px); margin:12px; padding:12px; }
      .footer-inner{ padding:6px }
      .bubble{ width:30px; height:30px; font-size:13px }
      .tf-table thead th:nth-child(1), .tf-table thead th:nth-child(3), .tf-table thead th:nth-child(4){ width:28px; }
    }
/* ========== Short answer (ph·∫ßn 3) ƒë·∫πp h∆°n ========== */
.short-answer {
  margin-top: 12px;
}

.short-answer input[type="text"],
.short-answer input[type="number"],
.short-answer textarea {
  width: 100%;
  max-width: 420px;
  padding: 12px 14px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid rgba(2,6,23,0.08);
  background: #f9fafb;
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.04);
  transition: all 0.25s ease;
}

.short-answer input:focus,
.short-answer textarea:focus {
  outline: none;
  background: #fff;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(14,165,183,0.25);
}

.short-answer small {
  display: block;
  margin-top: 6px;
  color: var(--muted);
  font-size: 13px;
}
.answer-result {
  margin-top: 8px;
  padding: 8px 10px;
  border-radius: 8px;
  font-weight: 600;
}

.answer-correct {
  background: #ecfdf5;
  color: #065f46;
  border: 1px solid #10b981;
}

.answer-wrong {
  background: #fef2f2;
  color: #7f1d1d;
  border: 1px solid #ef4444;
}

  </style>
</head>
<body>
  <!-- LOGIN OVERLAY (initial) -->
  <div id="loginScreen" class="overlay-screen" style="display:none;" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-label="ƒêƒÉng nh·∫≠p l√†m b√†i">
      <div style="font-weight:800;color:#0b2e6b;margin-bottom:10px;font-size:18px">ƒêƒÇNG NH·∫¨P L√ÄM B√ÄI</div>
      <div class="field"><label for="loginName">H·ªç v√† t√™n</label><input id="loginName" type="text" placeholder="Nguy·ªÖn VƒÉn A"></div>
      <div class="field"><label for="loginSBD">S·ªë b√°o danh (SBD)</label><input id="loginSBD" type="text" placeholder="00000001"></div>
      <div style="margin-top:12px; display:flex; gap:10px; justify-content:center">
        <button id="loginBtn" class="btn btn-primary">V√†o l√†m b√†i</button>
      </div>
    </div>
  </div>

  <!-- SCORE OVERLAY (separate form like login) -->
  <div id="scoreScreen" class="overlay-screen" style="display:none;" aria-hidden="true">
    <div class="card large" role="dialog" aria-modal="true" aria-label="K·∫øt qu·∫£ thi">
      <div id="scoreCardContent" style="font-size:15px;"></div>
      <div style="margin-top:18px; display:flex; gap:10px; justify-content:center">
        <button id="scoreBackBtn" class="btn btn-warning">Quay l·∫°i</button>
      </div>
    </div>
  </div>

  <!-- Candidate strip (original top strip) -->
  <div class="candidate-strip" role="region" aria-label="Th√¥ng tin th√≠ sinh">
    <div class="candidate-inner">
      <div class="candidate-info">
        <div class="name" id="candName">Nguy·ªÖn VƒÉn A</div>
        <div>SBD: <strong id="candSBD">00000001</strong></div>
        <div>M√¥n thi: <strong id="candSub">PH√ÅP LU·∫¨T ƒê·∫†I C∆Ø∆†NG</strong></div>
        <div>Ng√†y thi: <strong id="candDate">--/--/----</strong></div>
        <div>Ca thi: <strong id="candShift">2</strong></div>
      </div>

      <div class="candidate-controls">
        <div class="timer-bubble" id="timerHeader">90:00</div>
        <button class="btn-ghost" id="connStatus">üîå ƒêang k·∫øt n·ªëi</button>
        <button class="btn-primary" id="submitTopBtn">N·ªòP B√ÄI</button>
        <button class="btn-ghost" title="To√†n m√†n h√¨nh" id="fullscreenBtn">‚§¢</button>
      </div>
    </div>
  </div>

  <!-- Main content (original exam UI) -->
  <main class="page-wrap" id="pageWrap">
    <div class="content panel" id="contentPanel">
      <h1><br><br>ƒê·ªÄ 1 - CU·ªêI KH√ìA PLƒêC - K50</h1>

      <section id="scoreBanner" class="score-panel" aria-live="polite"></section>

      <div class="controls">
        <div style="color:var(--muted); align-self:center">ƒê√£ l√†m: <strong id="totalQ">0/...</strong></div>
        <button class="ghost" id="saveBtn">L∆∞u t·∫°m</button>
        <button class="ghost" id="clearBtn">X√≥a d·ªØ li·ªáu</button>
      </div>

      <section class="quiz-area">
        <div class="quiz-wrapper" id="quizWrapper">
          <form id="quizForm" autocomplete="off">
            <div id="part1" class="section"><h3>Th√≠ sinh ch·ªçn 1 trong 4 ph∆∞∆°ng √°n A, B, C ho·∫∑c D</h3></div>

            <div id="part2" class="section"><h3></h3></div>
            <div id="part3" class="section"><h3></h3></div>


        <div id="quizOverlay" class="quiz-overlay hidden" aria-hidden="true"><div class="msg"></div></div>
      </section>
    </div>
  </main>

  <!-- Footer (original) -->
  <footer class="site-footer" role="contentinfo" id="siteFooter">
    <div class="footer-inner" id="footerBubbles">
      <div class="bubbles-wrap" id="bubblesWrap"></div>
      <div class="footer-note" id="footerNote">ƒê√£ l√†m: <span id="footerTotal">0/...</span></div>
    </div>
  </footer>

  <script>

    /* ===== CONFIG (fixed) ===== */
    const DEV_SKIP_LOGIN = false; // b·∫≠t true ƒë·ªÉ ph√°t tri·ªÉn/test: b·ªè qua m√†n ƒëƒÉng nh·∫≠p
    const MCQ_COUNT = 20;
    const TF_COUNT = 0;
    const TF_ITEMS = 0;
    const SHORT_COUNT = 0;
    const TOTAL_Q = MCQ_COUNT + TF_COUNT + SHORT_COUNT;
    const TIMER_MIN = 20; // ph√∫t
    const TIMER_SEC = TIMER_MIN * 60;

    /* Answer key (for grading only) */
    const correct = {
      mcq: {1:'B',2:'D',3:'B',4:'C',5:'D',6:'A',7:'A',8:'A',9:'B',10:'A',11:'B',12:'A',13:'D',14:'C',15:'C', 16:'A', 17:'C',18:'B',19:'C',20:'D'},
    };

    /* STATE */
let displayToQnum = {}; // displayNum -> qNum
let qnumToDisplay = {}; // qNum -> displayNum

    let flagged = {};
    let submitted = false;
    let interval = null;
    let remaining = TIMER_SEC;

    /* ELEMENT REFS */
    const loginScreen = document.getElementById('loginScreen');
    const loginBtn = document.getElementById('loginBtn');
    const loginName = document.getElementById('loginName');
    const loginSBD = document.getElementById('loginSBD');

    const scoreScreen = document.getElementById('scoreScreen');
    const scoreCardContent = document.getElementById('scoreCardContent');
    const scoreBackBtn = document.getElementById('scoreBackBtn');

    const candNameEl = document.getElementById('candName');
    const candSbdEl = document.getElementById('candSBD');
    const timerHeader = document.getElementById('timerHeader');
    const submitTopBtn = document.getElementById('submitTopBtn');
    const fullscreenBtn = document.getElementById('fullscreenBtn');

    /* Helpers */
    function escapeHtml(s){ if(s===null||s===undefined) return ''; return String(s).replace(/[&<>\"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]); }

    function applyCandidateInfo(){
      const name = localStorage.getItem('exam_cand_name') || '‚Äî';
      const sbd = localStorage.getItem('exam_cand_sbd') || '‚Äî';
      candNameEl.textContent = name;
      candSbdEl.textContent = sbd;
    }

    function isLoggedIn(){ return !!localStorage.getItem('exam_cand_name') && !!localStorage.getItem('exam_cand_sbd'); }

    /* LOGIN flow */
    loginBtn.addEventListener('click', ()=>{
      const name = loginName.value.trim();
      const sbd = loginSBD.value.trim();
      if(!name || !sbd){ alert('Vui l√≤ng nh·∫≠p h·ªç t√™n v√† s·ªë b√°o danh.'); return; }
      localStorage.setItem('exam_cand_name', name);
      localStorage.setItem('exam_cand_sbd', sbd);
      applyCandidateInfo();
      loginScreen.style.display = 'none';
      loginScreen.setAttribute('aria-hidden','true');

      // load saved remaining or set default
      const storedRem = localStorage.getItem('quiz_remaining');
      if(storedRem === null) remaining = TIMER_SEC;
      else { remaining = parseInt(storedRem, 10); if(isNaN(remaining) || remaining < 0) remaining = TIMER_SEC; }

      // load saved answers (if any)
      // ki·ªÉm tra n·∫øu c√≥ d·ªØ li·ªáu ƒë√£ l∆∞u: h·ªèi th√≠ sinh c√≥ mu·ªën ti·∫øp t·ª•c hay b·∫Øt ƒë·∫ßu m·ªõi
      const rawSaved = localStorage.getItem('quiz_saved');
      let useSaved = false;
      if(rawSaved){
        useSaved = confirm('Ph√°t hi·ªán d·ªØ li·ªáu b√†i l√†m ƒë√£ l∆∞u. Ch·ªçn OK ƒë·ªÉ ti·∫øp t·ª•c v·ªõi d·ªØ li·ªáu l∆∞u, ho·∫∑c H·ªßy ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m m·ªõi (x√≥a d·ªØ li·ªáu c≈©).');
        if(useSaved){
          loadProgressAnswersIntoUI();
        } else {
          // x√≥a d·ªØ li·ªáu c≈© ƒë·ªÉ b·∫Øt ƒë·∫ßu phi√™n m·ªõi
          ['quiz_saved','quiz_result','quiz_remaining'].forEach(k=>localStorage.removeItem(k));
          // ƒë·∫£m b·∫£o UI s·∫°ch
          document.querySelectorAll('#quizWrapper input').forEach(el=>{ try{ if(el.type === 'radio') el.checked = false; if(el.type === 'number') el.value = ''; }catch(e){} });
          flagged = {};
          buildFooterBubbles();
          updateAnsweredCount();
        }
      } else {
        // kh√¥ng c√≥ d·ªØ li·ªáu ƒë√£ l∆∞u
        // nothing to do here
      }

      startTimer();
    });

    /* Show login if not logged (or allow dev skip) */
    function showLoginIfNeeded(){
      applyCandidateInfo();
      if(DEV_SKIP_LOGIN){
        // dev/test shortcut
        localStorage.setItem('exam_cand_name','Th√≠ sinh Test');
        localStorage.setItem('exam_cand_sbd','00000000');
        applyCandidateInfo();
        loginScreen.style.display = 'none';
        loginScreen.setAttribute('aria-hidden','true');
        return;
      }
      if(!isLoggedIn()){
        loginScreen.style.display = 'flex';
        loginScreen.setAttribute('aria-hidden','false');
      } else {
        loginScreen.style.display = 'none';
        loginScreen.setAttribute('aria-hidden','true');
      }
    }

    /* Build questions (same as original) */
    function renderQuestions(){
      const part1 = document.getElementById('part1'); part1.innerHTML = '<h3>Th√≠ sinh ch·ªçn 1 trong 4 ph∆∞∆°ng √°n A, B, C ho·∫∑c D</h3>';
      const part2 = document.getElementById('part2'); part2.innerHTML = '<h3></h3>';
      const part3 = document.getElementById('part3'); part3.innerHTML = '<h3></h3>';
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}
// T·∫°o m·∫£ng s·ªë c√¢u [1,2,3,...]
let order = [];
for (let i = 1; i <= MCQ_COUNT; i++) {
  order.push(i);
}

// ƒê·∫£o th·ª© t·ª± c√¢u h·ªèi
shuffle(order);

// Nh·∫≠p c√¢u h·ªèi
for (let idx = 0; idx < order.length; idx++) {
  const qNum = order[idx];
const displayNum = idx + 1;

displayToQnum[displayNum] = qNum;
qnumToDisplay[qNum] = displayNum;


  const q = document.createElement('div');
  q.className = 'question';
  q.dataset.qnum = qNum;

  let html = '';

  if (qNum === 1) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C∆° quan n√†o sau ƒë√¢y l√† c∆° quan h√†nh ch√≠nh c·ªßa n∆∞·ªõc C·ªông h√≤a x√£ h·ªôi ch·ªß nghƒ©a Vi·ªát Nam?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Vi·ªán ki·ªÉm s√°t nh√¢n d√¢n</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ·ª¶y ban nh√¢n d√¢n</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. T√≤a √°n nh√¢n d√¢n
</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. H·ªôi ƒë·ªìng nh√¢n d√¢n</label>
      </div>
    `;
  }
else if (qNum === 2) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Quy·ªÅn l·ª±c c√¥ng c·ªông ƒë·∫∑c bi·ªát c·ªßa nh√† n∆∞·ªõc ƒë∆∞·ª£c hi·ªÉu l√†</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. kh·∫£ nƒÉng s·ª≠ d·ª•ng s·ª©c m·∫°nh v≈© l·ª±c.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. kh·∫£ nƒÉng s·ª≠ d·ª•ng bi·ªán ph√°p thuy·∫øt ph·ª•c, gi√°o d·ª•c.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. c√≥ th·ªÉ s·ª≠ d·ª•ng quy·ªÅn l·ª±c kinh t·∫ø, ch√≠nh tr·ªã ho·∫∑c t∆∞ t∆∞·ªüng.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. vi·ªác s·ª≠ d·ª•ng s·ª©c m·∫°nh c∆∞·ª°ng ch·∫ø l√† ƒë·ªôc quy·ªÅn.</label>
      </div>
    `;
}
else if (qNum === 3) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">S·ª≠ d·ª•ng ph√°p lu·∫≠t l√†</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ch·ªß th·ªÉ ph√°p lu·∫≠t bu·ªôc th·ª±c hi·ªán nh·ªØng nghƒ©a v·ª• m√† ph√°p lu·∫≠t y√™u c·∫ßu.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ch·ªß th·ªÉ ph√°p lu·∫≠t ch·ªß ƒë·ªông th·ª±c hi·ªán quy·ªÅn c·ªßa m√¨nh theo quy ƒë·ªãnh c·ªßa ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ch·ªß th·ªÉ ph√°p lu·∫≠t ki·ªÅm ch·∫ø kh√¥ng th·ª±c hi·ªán nh·ªØng g√¨ m√† ph√°p lu·∫≠t ngƒÉn c·∫•m.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. c∆° quan nh√† n∆∞·ªõc s·ª≠ d·ª•ng ph√°p lu·∫≠t ƒë·ªÉ gi·∫£i quy·∫øt c√°c quan h·ªá ph√°p lu·∫≠t ph√°t sinh trong x√£ h·ªôi.</label>
      </div>
    `;
}
else if (qNum === 4) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Nh·∫≠n ƒë·ªãnh n√†o ƒë√∫ng?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Nh√† n∆∞·ªõc ch·ªß n√¥ l√† ki·ªÉu nh√† n∆∞·ªõc phong ki·∫øn.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. Nh√† n∆∞·ªõc li√™n bang l√† nh√† n∆∞·ªõc v·ªõi nhi·ªÅu h√¨nh th·ª©c ch√≠nh th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. Nh√† n∆∞·ªõc qu√¢n ch·ªß lu√¥n c√≥ ho√†ng gia.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. Nh√† n∆∞·ªõc n√†o c≈©ng c√≥ Vua.</label>
      </div>
    `;
}
else if (qNum === 5) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">CƒÉn c·ª© l√†m ph√°t sinh, thay ƒë·ªïi, ch·∫•m d·ª©t quan h·ªá ph√°p lu·∫≠t l√†</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. quy ph·∫°m ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. nƒÉng l·ª±c ch·ªß th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. s·ª± ki·ªán ph√°p l√Ω.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. quy ph·∫°m ph√°p lu·∫≠t, nƒÉng l·ª±c ch·ªß th·ªÉ v√† s·ª± ki·ªán ph√°p l√Ω.</label>
      </div>
    `;
}
else if (qNum === 6) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C·∫•u th√†nh c·ªßa quan h·ªá ph√°p lu·∫≠t bao g·ªìm:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ch·ªß th·ªÉ, kh√°ch th·ªÉ v√† n·ªôi dung.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ch·ªß th·ªÉ, kh√°ch th·ªÉ, m·∫∑t kh√°ch quan v√† m·∫∑t ch·ªß quan.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ch·ªß th·ªÉ, kh√°ch th·ªÉ, quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ch·ªß th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ch·ªß th·ªÉ, kh√°ch th·ªÉ, m·∫∑t kh√°ch quan, m·∫∑t ch·ªß quan, quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ch·ªß th·ªÉ.</label>
      </div>
    `;
}
else if (qNum === 7) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C√≥ c√°c lo·∫°i ch·∫ø t√†i c·ªßa quy ph·∫°m ph√°p lu·∫≠t sau ƒë√¢y:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ch·∫ø t√†i h√¨nh s·ª±, ch·∫ø t√†i d√¢n s·ª±, ch·∫ø t√†i h√†nh ch√≠nh, ch·∫ø t√†i k·ª∑ lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ch·∫ø t√†i h√¨nh s·ª±, ch·∫ø t√†i d√¢n s·ª±, ch·∫ø t√†i t√†i ch√≠nh, ch·∫ø t√†i h√†nh ch√≠nh.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ch·∫ø t√†i h√¨nh s·ª±, ch·∫ø t√†i d√¢n s·ª±, ch·∫ø t√†i t√†i ch√≠nh, ch·∫ø t√†i k·ª∑ lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ch·∫ø t√†i h√¨nh s·ª±, ch·∫ø t√†i d√¢n s·ª±, ch·∫ø t√†i th∆∞∆°ng m·∫°i, ch·∫ø t√†i k·ª∑ lu·∫≠t.</label>
      </div>
    `;
}
else if (qNum === 8) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Ngu·ªìn g·ªëc ra ƒë·ªùi c·ªßa nh√† n∆∞·ªõc l√†:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. s·ª± xu·∫•t hi·ªán ch·∫ø ƒë·ªô t∆∞ h·ªØu v√† ph√¢n h√≥a giai c·∫•p.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. √Ω ch√≠ c·ªßa giai c·∫•p th·ªëng tr·ªã.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. s·ª± th·ªèa thu·∫≠n c·ªßa m·ªçi giai c·∫•p trong x√£ h·ªôi.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. s·ª± xu·∫•t hi·ªán ch·∫ø ƒë·ªô t∆∞ h·ªØu.</label>
      </div>
    `;
}
else if (qNum === 9) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">NƒÉng l·ª±c ch·ªß th·ªÉ c·ªßa quan h·ªá ph√°p lu·∫≠t bao g·ªìm:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. nƒÉng l·ª±c ph√°p lu·∫≠t, nƒÉng l·ª±c h√†nh vi v√† nƒÉng l·ª±c nh·∫≠n th·ª©c.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. nƒÉng l·ª±c ph√°p lu·∫≠t v√† nƒÉng l·ª±c h√†nh vi.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. nƒÉng l·ª±c h√†nh vi v√† nƒÉng l·ª±c nh·∫≠n th·ª©c.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. nƒÉng l·ª±c ph√°p lu·∫≠t v√† nƒÉng l·ª±c nh·∫≠n th·ª©c.</label>
      </div>
    `;
}
else if (qNum === 10) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">ƒê·∫£ng C·ªông s·∫£n Vi·ªát Nam l√† thi·∫øt ch·∫ø thu·ªôc h·ªá th·ªëng n√†o sau ƒë√¢y?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. H·ªá th·ªëng ch√≠nh tr·ªã.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. H·ªá th·ªëng c∆° quan, quy·ªÅn l·ª±c nh√† n∆∞·ªõc.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. H·ªá th·ªëng c∆° quan qu·∫£n l√Ω nh√† n∆∞·ªõc.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. Thu·ªôc Nh√† n∆∞·ªõc.</label>
      </div>
    `;
}
else if (qNum === 11) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Vai tr√≤ c·ªßa Ch√≠nh ph·ªß l√†</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ho·∫°t ƒë·ªông l·∫≠p ph√°p.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. thi h√†nh ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. b·ªï nhi·ªám th·∫©m ph√°n c·ªßa t√≤a √°n.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ƒë√≥ng vai tr√≤ nguy√™n th·ªß qu·ªëc gia.</label>
      </div>
    `;
}
else if (qNum === 12) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C∆° quan nh√† n∆∞·ªõc n√†o sau ƒë√¢y ƒë√≥ng vai tr√≤ x√¢y d·ª±ng ph√°p lu·∫≠t?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Qu·ªëc h·ªôi.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. Ch√≠nh ph·ªß.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. Nguy√™n th·ªß qu·ªëc gia.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. T√≤a √°n.</label>
      </div>
    `;
}
else if (qNum === 13) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">T·ªïng th·ªëng, Ch·ªß t·ªãch n∆∞·ªõc, Nh√† vua, N·ªØ ho√†ng ƒë·ªÅu ph√π h·ª£p v·ªõi tr∆∞·ªùng h·ª£p n√†o sau ƒë√¢y?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Do c∆° quan l·∫≠p ph√°p b·∫ßu ra.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ƒê·ª©ng ƒë·∫ßu c∆° quan H√†nh ph√°p.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ƒê·ª©ng ƒë·∫ßu c∆° quan T∆∞ ph√°p.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. Nguy√™n th·ªß qu·ªëc gia.</label>
      </div>
    `;
}
else if (qNum === 14) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C·∫•u th√†nh c·ªßa quy ph·∫°m ph√°p lu·∫≠t bao g·ªìm:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. m·∫∑t ch·ªß quan, m·∫∑t kh√°ch quan.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ch·ªß th·ªÉ, kh√°ch th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. gi·∫£ ƒë·ªãnh, quy ƒë·ªãnh, ch·∫ø t√†i.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. m·∫∑t kh√°ch th·ªÉ v√† m·∫∑t ch·ªß quan.</label>
      </div>
    `;
}
else if (qNum === 15) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">H√¨nh th·ª©c ch√≠nh th·ªÉ c·ªßa nh√† n∆∞·ªõc XHCN l√†:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ch·ª©c nƒÉng ƒë·ªëi ngo·∫°i.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ph√°t tri·ªÉn kinh t·∫ø v√† ·ªïn ƒë·ªãnh tr·∫≠t t·ª± x√£ h·ªôi.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. nh·ªØng ph∆∞∆°ng di·ªán ho·∫°t ƒë·ªông c∆° b·∫£n c·ªßa nh√† n∆∞·ªõc.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ch·ª©c nƒÉng ƒë·ªëi n·ªôi.</label>
      </div>
    `;
}
else if (qNum === 16) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Ch·∫•p h√†nh ph√°p lu·∫≠t l√†</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ch·ªß th·ªÉ ph√°p lu·∫≠t bu·ªôc th·ª±c hi·ªán nh·ªØng nghƒ©a v·ª• m√† ph√°p lu·∫≠t y√™u c·∫ßu b·∫±ng h√†nh ƒë·ªông c·ª• th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ch·ªß th·ªÉ ph√°p lu·∫≠t ki·ªÅm ch·∫ø kh√¥ng th·ª±c hi·ªán nh·ªØng g√¨ m√† ph√°p lu·∫≠t ngƒÉn c·∫•m.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ch·ªß th·ªÉ ph√°p lu·∫≠t th·ª±c hi·ªán quy·ªÅn m√† ph√°p lu·∫≠t cho ph√©p.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. c∆° quan nh√† n∆∞·ªõc √°p d·ª•ng ph√°p lu·∫≠t ƒë·ªÉ gi·∫£i quy·∫øt c√°c quan h·ªá ph√°p lu·∫≠t ph√°t sinh trong x√£ h·ªôi.</label>
      </div>
    `;
}
else if (qNum === 17) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Vi·ªác ·ª¶y ban nh√¢n d√¢n c·∫•p x√£ ch·ª©ng th·ª±c s∆° y·∫øu l√Ω l·ªãch t·ª± thu·∫≠t l√† h√¨nh th·ª©c th·ª±c hi·ªán ph√°p lu·∫≠t n√†o?</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Tu√¢n th·ªß ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. Thi h√†nh ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. √Åp d·ª•ng ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. S·ª≠ d·ª•ng ph√°p lu·∫≠t.</label>
      </div>
    `;
}
else if (qNum === 18) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">Trong ch√≠nh th·ªÉ c·ªông h√≤a d√¢n ch·ªß:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. quy·ªÅn l·ª±c t·ªëi cao c·ªßa nh√† n∆∞·ªõc t·∫≠p trung m·ªôt ph·∫ßn trong tay ng∆∞·ªùi ƒë·ª©ng ƒë·∫ßu nh√† n∆∞·ªõc.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. m·ªçi c√¥ng d√¢n ƒë·ªß ƒëi·ªÅu ki·ªán ph√°p lu·∫≠t quy ƒë·ªãnh c√≥ quy·ªÅn b·∫ßu c·ª≠ ƒë·ªÉ l·∫≠p ra c∆° quan quy·ªÅn l·ª±c nh√† n∆∞·ªõc cao nh·∫•t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ng∆∞·ªùi ƒë·ª©ng ƒë·∫ßu nh√† n∆∞·ªõc c√≥ quy·ªÅn l·ª±c v√¥ h·∫°n.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ch·ªâ t·∫ßng l·ªõp qu√Ω t·ªôc m·ªõi c√≥ quy·ªÅn b·∫ßu c·ª≠ ƒë·ªÉ l·∫≠p ra c∆° quan quy·ªÅn l·ª±c nh√† n∆∞·ªõc cao nh·∫•t.</label>
      </div>
    `;
}
else if (qNum === 19) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C·∫•u th√†nh c·ªßa vi ph·∫°m ph√°p lu·∫≠t bao g·ªìm:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. Ch·ªß th·ªÉ, kh√°ch th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. M·∫∑t ch·ªß quan, m·∫∑t kh√°ch quan.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. M·∫∑t kh√°ch quan, m·∫∑t ch·ªß quan, ch·ªß th·ªÉ, kh√°ch th·ªÉ.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. Gi·∫£ ƒë·ªãnh, quy ƒë·ªãnh, ch·∫ø t√†i.</label>
      </div>
    `;
}
else if (qNum === 20) {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">C·∫•u tr√∫c c·ªßa h·ªá th·ªëng ph√°p lu·∫≠t g·ªìm:</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. quy ph·∫°m ph√°p lu·∫≠t v√† ch·∫ø ƒë·ªãnh ph√°p lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. gi·∫£ ƒë·ªãnh, quy ƒë·ªãnh, ch·∫ø t√†i, ch·∫ø ƒë·ªãnh, ph√°p lu·∫≠t, ng√†nh lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ch·∫ø ƒë·ªãnh ph√°p lu·∫≠t v√† ng√†nh lu·∫≠t.</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. quy ph·∫°m ph√°p lu·∫≠t, ch·∫ø ƒë·ªãnh ph√°p lu·∫≠t, ng√†nh lu·∫≠t.</label>
      </div>
    `;
}
 
 else {
    html = `
      <div class="q-head">
        <div class="q-left">
          <div class="qnum">${displayNum}</div>
          <div class="qtitle">N·ªôi dung c√¢u ${qNum}</div>
        </div>
        <button type="button" class="flag-btn" data-qnum="${qNum}">üö© G·∫Øn c·ªù</button>
      </div>
      <div class="options">
        <label class="option"><input type="radio" name="p1q${qNum}" value="A"> A. ƒê√°p √°n A</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="B"> B. ƒê√°p √°n B</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="C"> C. ƒê√°p √°n C</label>
        <label class="option"><input type="radio" name="p1q${qNum}" value="D"> D. ƒê√°p √°n D</label>
      </div>
    `;
  }

  q.innerHTML = html;
  part1.appendChild(q);
}


  


      // attach delegated event listeners for flag buttons (works even after render)
      document.querySelectorAll('.flag-btn').forEach(btn=>{
        btn.removeEventListener('click', flagBtnHandler);
        btn.addEventListener('click', flagBtnHandler);
      });

      enableMcqToggle();
      enableFocusScrolling();
      buildFooterBubbles();
      loadProgressAnswersIntoUI();
      updateAnsweredCount();
    }

    function flagBtnHandler(e){
      const qNum = Number(this.dataset.qnum || e.currentTarget.dataset.qnum);
      toggleFlag(qNum, this);
    }

    renderQuestions();

    /* MCQ toggle (click selected to unselect) */
    function enableMcqToggle(){
      const radios = document.querySelectorAll("input[type='radio'][name^='p1q']");
      radios.forEach(radio=>{
        radio.addEventListener('mousedown', function(){ this._wasChecked = this.checked; });
        radio.addEventListener('click', function(e){
          if(this._wasChecked){
            this.checked = false;
            this.dispatchEvent(new Event('change', { bubbles: true }));
            e.preventDefault();
          }
        });
      });
    }

    function enableFocusScrolling(){
      // attach focus handler to dynamically created inputs (delegation not necessary here)
      const inputs = document.querySelectorAll('#quizWrapper input, #quizWrapper textarea, #quizWrapper select');
      inputs.forEach(inp=>{
        inp.removeEventListener('focus', focusScrollHandler);
        inp.addEventListener('focus', focusScrollHandler, {passive:true});
      });
    }
    function focusScrollHandler(evt){
      setTimeout(()=>{
        const footerH = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--footer-height')) || 120;
        const rect = evt.target.getBoundingClientRect();
        const viewportAvailable = window.innerHeight - footerH - 24;
        if(rect.bottom > viewportAvailable){
          const delta = rect.bottom - viewportAvailable + 12;
          window.scrollBy({ top: delta, behavior: 'smooth' });
        }
      }, 80);
    }

    /* FLAG */
    function toggleFlag(qNum, btn){
      flagged[qNum] = !flagged[qNum];
      if(btn){ btn.textContent = flagged[qNum] ? 'üö© B·ªè c·ªù' : 'üö© G·∫Øn c·ªù'; }
      updateFooterBubble(qNum);
      updateAnsweredCount();
    }
    window.toggleFlag = toggleFlag;

    /* Footer bubble logic */
function buildFooterBubbles(){
  const wrap = document.getElementById('bubblesWrap');
  wrap.innerHTML = '';

  for(let displayNum = 1; displayNum <= TOTAL_Q; displayNum++){
    const qNum = displayToQnum[displayNum];

    const b = document.createElement('button');
    b.className = 'bubble';
    b.textContent = displayNum;
    b.dataset.display = displayNum;
    b.dataset.qnum = qNum;

    b.title = 'C√¢u ' + displayNum;
    b.addEventListener('click', ()=>{ scrollToQuestion(qNum); });

    wrap.appendChild(b);
  }

  for(let i=1;i<=TOTAL_Q;i++) updateFooterBubble(i);
}


    function isAnswered(qNum){
      if(qNum <= MCQ_COUNT) return !!document.querySelector(`input[name='p1q${qNum}']:checked`);
      else if(qNum <= MCQ_COUNT + TF_COUNT){
        const idx = qNum - MCQ_COUNT;
        for(let j=1;j<=TF_ITEMS;j++) if(document.querySelector(`input[name='p2q${idx}y${j}']:checked`)) return true;
        return false;
      } else {
        const idx = qNum - MCQ_COUNT - TF_COUNT;
        const el = document.querySelector(`input[name='p3q${idx}']`);
        return el && el.value !== '';
      }
    }

function updateFooterBubble(qNum){
  const displayNum = qnumToDisplay[qNum];
  const btn = document.querySelector(`.bubble[data-display='${displayNum}']`);
  if(!btn) return;

  btn.classList.remove('done','flagged');
  if(flagged[qNum]) btn.classList.add('flagged');
  else if(isAnswered(qNum)) btn.classList.add('done');
}

    function updateAnsweredCount(){
      let done = 0;
      for(let i=1;i<=TOTAL_Q;i++) if(isAnswered(i)) done++;
      const txt = `${done}/${TOTAL_Q}`;
      const dom = document.getElementById('totalQ');
      const foot = document.getElementById('footerTotal');
      if(dom) dom.textContent = txt;
      if(foot) foot.textContent = txt;
    }

    document.addEventListener('change', (e)=>{
      const name = e.target.name;
      if(!name) return;
      let qNum = null;
      if(name.startsWith('p1q')) qNum = Number(name.replace('p1q',''));
      else if(name.startsWith('p2q')){ const m = name.match(/p2q(\d+)y(\d+)/); if(m) qNum = MCQ_COUNT + Number(m[1]); }
      else if(name.startsWith('p3q')) qNum = MCQ_COUNT + TF_COUNT + Number(name.replace('p3q',''));
      if(qNum) updateFooterBubble(qNum);
      updateAnsweredCount();
    });

    function scrollToQuestion(qNum){
      const el = document.querySelector(`[data-qnum='${qNum}']`);
      if(el) el.scrollIntoView({behavior:'smooth', block:'center'});
    }

    /* FOOTER height handling */
    function updateFooterHeight(){
      const footer = document.getElementById('siteFooter');
      if(!footer) return;
      const h = footer.offsetHeight || 120;
      document.documentElement.style.setProperty('--footer-height', h + 'px');
    }
    window.addEventListener('resize', ()=>{ updateFooterHeight(); });
    window.addEventListener('load', ()=>{ updateFooterHeight(); setTimeout(updateFooterHeight, 300); });

    /* TIMER behavior */
    (function initRemaining(){
      const storedRem = localStorage.getItem('quiz_remaining');
      if(storedRem === null) remaining = TIMER_SEC;
      else { remaining = parseInt(storedRem, 10); if(isNaN(remaining) || remaining < 0) remaining = TIMER_SEC; }
    })();

    function updateTimerDisplay(){
      const m = Math.floor(remaining / 60);
      const s = remaining % 60;
      const txt = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
      const th = document.getElementById('timerHeader');
      if(th) th.textContent = txt;
    }

    function startTimer(){
      if(interval) clearInterval(interval);
      updateTimerDisplay();
      if(submitted) return;
      interval = setInterval(()=>{
        if(remaining <= 0){ clearInterval(interval); autoSubmit(); return; }
        remaining--;
        localStorage.setItem('quiz_remaining', remaining);
        updateTimerDisplay();
      }, 1000);
    }

    /* SAVE / LOAD progress */
    document.getElementById('saveBtn').addEventListener('click', ()=>{ saveProgress(); alert('ƒê√£ l∆∞u t·∫°m (localStorage).'); });
    document.getElementById('clearBtn').addEventListener('click', ()=>{ if(confirm('X√≥a d·ªØ li·ªáu local?')){ localStorage.clear(); location.reload(); } });

    function saveProgress(){
      const data = { mcq:{}, tf:{}, short:{}, flagged, remaining };
      for(let i=1;i<=MCQ_COUNT;i++){ data.mcq[i] = (document.querySelector(`input[name='p1q${i}']:checked`)||{}).value || null; }
      for(let i=1;i<=TF_COUNT;i++){ data.tf[i] = []; for(let j=1;j<=TF_ITEMS;j++){ data.tf[i].push((document.querySelector(`input[name='p2q${i}y${j}']:checked`)||{}).value || null); } }
      for(let i=1;i<=SHORT_COUNT;i++){ data.short[i] = (document.querySelector(`input[name='p3q${i}']`)||{}).value || ''; }
      try{
        localStorage.setItem('quiz_saved', JSON.stringify(data));
        localStorage.setItem('quiz_remaining', remaining);
      }catch(e){ console.warn('L∆∞u kh√¥ng th√†nh c√¥ng', e); }
    }

    function loadProgressAnswersIntoUI(){
      const raw = localStorage.getItem('quiz_saved'); if(!raw) return false;
      try{
        const data = JSON.parse(raw);
        if(data.mcq) for(let i=1;i<=MCQ_COUNT;i++){ const v = data.mcq[i]; if(v){ const el = document.querySelector(`input[name='p1q${i}'][value='${v}']`); if(el) el.checked = true; } }
        if(data.tf) for(let i=1;i<=TF_COUNT;i++){ for(let j=1;j<=TF_ITEMS;j++){ const v = data.tf[i] && data.tf[i][j-1]; if(v){ const el = document.querySelector(`input[name='p2q${i}y${j}'][value='${v}']`); if(el) el.checked = true; } } }
        if(data.short) for(let i=1;i<=SHORT_COUNT;i++){ const v = data.short[i]; if(v !== ''){ const el = document.querySelector(`input[name='p3q${i}']`); if(el) el.value = v; } }
        if(data.flagged) flagged = data.flagged;
        // remaining priority: stored remaining key else data.remaining inside quiz_saved
        if(data.remaining) { remaining = Number(data.remaining); }
        else { const lr = localStorage.getItem('quiz_remaining'); if(lr !== null) remaining = Number(lr); }
        updateTimerDisplay();
        return true;
      }catch(e){ console.warn('Kh√¥ng th·ªÉ load progress', e); return false; }
    }

    /* SCORING */
    function computeScore(){
      let score = 0;
      const breakdown = {
        mcq: { total: MCQ_COUNT, correct:0, score:0, max: MCQ_COUNT * 1 },
        tf: { total: TF_COUNT, score:0, details:[], max: TF_COUNT * 0 },
        short: { total: SHORT_COUNT, correct:0, score:0, max: SHORT_COUNT * 0.0 }
      };

      for(let i=1;i<=MCQ_COUNT;i++){
        const user = (document.querySelector(`input[name='p1q${i}']:checked`)||{}).value || null;
        if(user && user === correct.mcq[i]){ breakdown.mcq.correct++; breakdown.mcq.score += 1; score += 1; }
      }

      for(let i=1;i<=TF_COUNT;i++){
        let correctCount = 0;
        for(let j=1;j<=TF_ITEMS;j++){
          const sel = (document.querySelector(`input[name='p2q${i}y${j}']:checked`)||{}).value;
          if(sel !== undefined && sel !== null && sel !== ''){
            if((sel === 'true') === correct.tf[i][j-1]) correctCount++;
          }
        }
        let pts = 0;
        if(correctCount === 4) pts = 1;
        else if(correctCount === 3) pts = 0.5;
        else if(correctCount === 2) pts = 0.25;
        else if(correctCount === 1) pts = 0.1;
        breakdown.tf.details.push({ q:i, correctCount, pts });
        breakdown.tf.score += pts; score += pts;
      }

      for(let i=1;i<=SHORT_COUNT;i++){
        const v = (document.querySelector(`input[name='p3q${i}']`)||{}).value;
        if(v !== '' && !isNaN(Number(v)) && Number(v) === correct.short[i]){ breakdown.short.correct++; breakdown.short.score += 0.5; score += 0.5; }
      }

      return { score, breakdown };
    }

    function showScoreBanner(result){
      const res = (result && result.score !== undefined) ? result : { score: result };
      if(!res.breakdown){
        const comp = computeScore(); res.score = comp.score; res.breakdown = comp.breakdown;
      }
      const maxScore = res.breakdown.mcq.max + res.breakdown.tf.max + res.breakdown.short.max;
      const pct = Math.round((res.score / maxScore) * 10000) / 100;
      const sb = document.getElementById('scoreBanner');
      sb.style.display = 'block';
      sb.innerHTML = `
        <div style="display:flex;flex-direction:column;gap:10px;align-items:center">
          <div class="score-title">ƒêi·ªÉm t·ªïng: <strong style="font-size:20px">${res.score}/${maxScore}</strong> ‚Äî <span class="score-sub">${pct}%</span></div>
·∫§n n√∫t x√≥a d·ªØ li·ªáu ƒë·ªÉ l√†m l·∫°i
            <tbody>
      
     
            </tbody>
          </table>
        </div>
      `;
    }

    /* SUBMIT & LOCK (fixed behavior) */
    submitTopBtn.addEventListener('click', ()=>{ if(confirm('B·∫°n ch·∫Øc mu·ªën n·ªôp b√†i?')) doSubmit(); });

    function lockUI(){
      document.getElementById('quizOverlay').classList.remove('hidden');
      document.getElementById('quizOverlay').setAttribute('aria-hidden','false');
      // ch·ªâ disable c√°c input/textarea/select ‚Äî gi·ªØ nguy√™n c√°c n√∫t ƒëi·ªÅu h∆∞·ªõng n·∫øu c·∫ßn
      document.querySelectorAll('#quizWrapper input, #quizWrapper textarea, #quizWrapper select').forEach(el=>{
        try{ el.disabled = true; el.setAttribute('aria-disabled','true'); }catch(e){}
      });
      try{ document.getElementById('submitTopBtn').disabled = true; }catch(e){}
    }

    function doSubmit(isAuto=false){
  
if(submitted) return;
  submitted = true;

  if(interval) clearInterval(interval);
  remaining = 0;
  localStorage.setItem('quiz_remaining', 0);

  saveProgress();

  const res = computeScore();
  showScoreBanner(res);      // ‚úÖ b·∫£ng ƒëi·ªÉm ƒë·∫ßu trang
  lockUI();
  showCorrectWrongPerQuestion(); // ‚úÖ hi·ªán ƒë√∫ng / sai t·ª´ng c√¢u

  localStorage.setItem('quiz_result', JSON.stringify({
    score: res.score,
    breakdown: res.breakdown,
    submittedAt: new Date().toISOString()
  }));

  document.getElementById('scoreBanner')
    .scrollIntoView({ behavior: 'smooth', block: 'start' });

  updateAnsweredCount();
}


    function autoSubmit(){ if(!submitted) doSubmit(true); }

    // IMPORTANT: thay v√¨ auto-submit khi unload/visibility change ‚Äî ch√∫ng ta ch·ªâ l∆∞u ti·∫øn tr√¨nh ƒë·ªÉ tr√°nh kh√≥a kh√¥ng mong mu·ªën
    window.addEventListener('beforeunload', function(e){
      if(!submitted){ try{ saveProgress(); e.returnValue = 'B·∫°n ch∆∞a n·ªôp b√†i. Trang s·∫Ω l∆∞u t·∫°m b√†i l√†m.'; }catch(err){} }
    });

    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden && !submitted){ try{ saveProgress(); }catch(e){} }
    });

    /* Score overlay content + Quay l·∫°i button (clears data and goes to login) */
    function showScorePage(result){
      const res = result && result.breakdown ? result : computeScore();
      const maxScore = res.breakdown.mcq.max + res.breakdown.tf.max + res.breakdown.short.max;
      const pct = Math.round((res.score / maxScore) * 10000) / 100;
      scoreCardContent.innerHTML = `
        <div style="text-align:center">
          <div style="font-weight:800;font-size:18px;margin-bottom:6px">K·∫æT QU·∫¢ B√ÄI THI</div>
          <div style="margin-bottom:10px">Th√≠ sinh: <strong>${escapeHtml(localStorage.getItem('exam_cand_name')||'‚Äî')}</strong> | SBD: <strong>${escapeHtml(localStorage.getItem('exam_cand_sbd')||'‚Äî')}</strong></div>
          <div style="font-size:20px;margin-bottom:8px">ƒêi·ªÉm t·ªïng: <strong>${res.score}/${maxScore}</strong> ‚Äî ${pct}%</div>
          <table style="width:100%; border-collapse:collapse; margin-top:8px; font-size:15px">
            <thead><tr><th style="border:1px solid #ddd;padding:10px">Ph·∫ßn</th><th style="border:1px solid #ddd;padding:10px">S·ªë c√¢u</th><th style="border:1px solid #ddd;padding:10px">ƒê√∫ng</th><th style="border:1px solid #ddd;padding:10px">ƒêi·ªÉm</th></tr></thead>
            <tbody>
              <tr><td style="border:1px solid #ddd;padding:10px">Tr·∫Øc nghi·ªám</td><td style="border:1px solid #ddd;padding:10px">${res.breakdown.mcq.total}</td><td style="border:1px solid #ddd;padding:10px">${res.breakdown.mcq.correct}</td><td style="border:1px solid #ddd;padding:10px">${res.breakdown.mcq.score}</td></tr>
                         </tbody>
          </table>
        </div>
      `;
      scoreScreen.style.display = 'flex';
      scoreScreen.setAttribute('aria-hidden','false');
    }

    /* RESET / QUAY L·∫†I: clear all exam data and return to login */
    function resetExamStateAndGoToLogin(){
      // clear all keys related to exam & candidate
      const keysToRemove = ['quiz_saved','quiz_remaining','quiz_result','quiz_selected','exam_cand_name','exam_cand_sbd'];
      keysToRemove.forEach(k=>localStorage.removeItem(k));

      // stop timer
      if(interval){ clearInterval(interval); interval = null; }

      // reset state variables
      submitted = false;
      flagged = {};
      remaining = TIMER_SEC;

      // hide overlays
      scoreScreen.style.display = 'none';
      scoreScreen.setAttribute('aria-hidden','true');
      document.getElementById('scoreBanner').style.display = 'none';
      document.getElementById('scoreBanner').innerHTML = '';

      // unlock inputs and clear answers
      document.querySelectorAll('#quizWrapper input').forEach(el=>{
        try{
          el.disabled = false;
          el.removeAttribute('aria-disabled');
          if(el.type === 'radio') el.checked = false;
          if(el.type === 'number') el.value = '';
        }catch(e){}
      });

      // enable submit button
      const sb = document.getElementById('submitTopBtn');
      if(sb){ sb.disabled = false; }

      // reset candidate strip display to placeholders
      document.getElementById('candName').textContent = '‚Äî';
      document.getElementById('candSBD').textContent = '‚Äî';

      // rebuild footer bubbles/ UI
      buildFooterBubbles();
      updateAnsweredCount();

      // show login screen
      loginScreen.style.display = 'flex';
      loginScreen.setAttribute('aria-hidden','false');

      // reset login form fields for fresh input
      loginName.value = '';
      loginSBD.value = '';
    }

    scoreBackBtn.addEventListener('click', ()=>{
      if(!confirm('Quay l·∫°i s·∫Ω x√≥a d·ªØ li·ªáu ƒë√£ l∆∞u (b√†i, th·ªùi gian, k·∫øt qu·∫£) v√† ƒëƒÉng xu·∫•t. B·∫°n c√≥ ch·∫Øc mu·ªën quay l·∫°i?')) return;
      resetExamStateAndGoToLogin();
    });

    /* Init */
    (function init(){
      // render questions first
      renderQuestions();
function updateExamDateRealtime() {
  const d = new Date();
  const day = String(d.getDate()).padStart(2, '0');
  const month = String(d.getMonth() + 1).padStart(2, '0');
  const year = d.getFullYear();
  document.getElementById('candDate').textContent = `${day}/${month}/${year}`;
}

// g·ªçi khi trang load
updateExamDateRealtime();

      // show login if not logged
      showLoginIfNeeded();

      // check if previous result exists
      const prevResultRaw = localStorage.getItem('quiz_result');
      if(prevResultRaw){
        try{
          const prev = JSON.parse(prevResultRaw);
          submitted = true;
          lockUI();
          remaining = 0;
          updateTimerDisplay();
          showScoreBanner(prev);

        }catch(e){}
      } else {
        const storedRem = localStorage.getItem('quiz_remaining');
        if(storedRem === null) remaining = TIMER_SEC;
        else { remaining = parseInt(storedRem, 10); if(isNaN(remaining) || remaining < 0) remaining = TIMER_SEC; }
      }

      if(isLoggedIn() && !submitted){
        loadProgressAnswersIntoUI();
        startTimer();
      }

      for(let i=1;i<=TOTAL_Q;i++) updateFooterBubble(i);
      updateAnsweredCount();
      enableMcqToggle();
      updateFooterHeight();
      setTimeout(updateFooterHeight, 300);
      applyCandidateInfo();

      // fullscreen button
      fullscreenBtn.addEventListener('click', ()=>{ if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen(); });

    })();
function showCorrectWrongPerQuestion() {
  for (let i = 1; i <= MCQ_COUNT; i++) {
    const q = document.querySelector(`.question[data-qnum='${i}']`);
    if (!q) continue;

    const user = (document.querySelector(`input[name='p1q${i}']:checked`) || {}).value || '‚Äî';
    const right = correct.mcq[i];

    const box = document.createElement('div');
    box.className = 'answer-result ' + (user === right ? 'answer-correct' : 'answer-wrong');

    if (user === right) {
      box.innerHTML = `‚úÖ <strong>ƒê√∫ng</strong> ‚Äî B·∫°n ch·ªçn <strong>${user}</strong>`;
    } else {
      box.innerHTML = `‚ùå <strong>Sai</strong> ‚Äî B·∫°n ch·ªçn <strong>${user}</strong>, ƒë√°p √°n ƒë√∫ng: <strong>${right}</strong>`;
    }

    q.appendChild(box);
  }
}
/* ===== ANTI COPY / ANTI CHEAT ===== */
(function antiCopy(){
  // 1. Ch·∫∑n menu chu·ªôt ph·∫£i
  document.addEventListener('contextmenu', function(e){
    e.preventDefault();
  });

  // 2. Ch·∫∑n b√¥i ƒëen + copy
  document.addEventListener('copy', e => e.preventDefault());
  document.addEventListener('cut', e => e.preventDefault());
  document.addEventListener('paste', e => e.preventDefault());
  document.addEventListener('selectstart', e => e.preventDefault());

  // 3. Ch·∫∑n ph√≠m t·∫Øt nguy hi·ªÉm
  document.addEventListener('keydown', function(e){
    const k = e.key.toLowerCase();

    // Ctrl + ...
    if (e.ctrlKey && (
      k === 'c' || // copy
      k === 'x' || // cut
      k === 'v' || // paste
      k === 'a' || // select all
      k === 'p' || // print
      k === 's'    // save
    )) {
      e.preventDefault();
      return false;
    }

    // F12, Ctrl+Shift+I/J/C (DevTools)
    if (
      k === 'f12' ||
      (e.ctrlKey && e.shiftKey && (k === 'i' || k === 'j' || k === 'c'))
    ) {
      e.preventDefault();
      return false;
    }
  });

  // 4. Ch·∫∑n k√©o th·∫£
  document.addEventListener('dragstart', e => e.preventDefault());

  // 5. CSS ch·ªëng b√¥i ƒëen (fallback)
  const style = document.createElement('style');
  style.innerHTML = `
    body {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    input, textarea {
      user-select: auto; /* v·∫´n cho nh·∫≠p */
    }
  `;
  document.head.appendChild(style);
})();

  </script>
</body>
</html>
